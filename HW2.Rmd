---
title: "BM2_HW2"
author: "Yangyang Chen"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r, include = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
library(viridis)
library(modelr)
library(mgcv)
library(latex2exp)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d

theme_set(theme_minimal() + theme(legend.position = "bottom"))
```

## Problem_1

### (a)
```{r}
# load data
dose=c(0, 1, 2, 3, 4)## x_i
num=c(30, 30, 30, 30, 30) ## m_i
killed=c(2, 8, 15, 23, 27) ## y_i
data=data.frame(dose,num,killed) ## (x_i, m_i, y_i)
```

```{r}
# data preparation
x=data$dose
y=data$killed
m=data$num
resp=cbind(y,m-y)   #### counts of success (death=1), failure (surv=0)
```

```{r}
glm_logit=glm(resp~x, family=binomial(link='logit'))
glm_probit=glm(resp~x, family=binomial(link='probit'))
glm_clog=glm(resp~x, family=binomial(link='cloglog')) # asymmetric
summary(glm_logit) # Wald test of coefficients
summary(glm_probit)
summary(glm_clog)
```

```{r}
out=predict(glm_logit, data.frame(x=c(0.01)), se.fit=TRUE)
out
```

### (b)
```{r}
dose=c(0, 1, 2, 3, 4)## x_i
num=c(30, 30, 30, 30, 30) ## m_i
killed=c(2, 8, 15, 23, 27) ## y_i
log10Dose=log10(dose)
data=data.frame(log10Dose,num,killed) ## (x_i, m_i, y_i)

# data preparation
x=data$log10Dose
y=data$killed
m=data$num
resp=cbind(y,m-y)   #### counts of success (death=1), failure (surv=0)
```
<!-- glm_logit=glm(resp~x, family=binomial(link='logit')) -->
<!-- glm_probit=glm(resp~x, family=binomial(link='probit')) -->
<!-- glm_clog=glm(resp~x, family=binomial(link='cloglog')) # asymmetric -->
<!-- summary(glm_logit) # Wald test of coefficients -->
<!-- summary(glm_probit) -->
<!-- summary(glm_clog) -->
```

